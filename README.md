

## Проект представляет из себя To-Do + Pomodoro + Gamefication + Habit tracker. 
##Пользователю предоставляеться возможность создавать задачи или привычки которые он хотел бы соблюдать.
##Дела из To-Do  можно выполнять по методике pomodoro. 
##Для привычек есть отдельный каллендарь для отслеживания результата.
##За соблюдение привычек и закрытие задач To-Do пользователь получает exp который повышает уровень и возможность прокачивать статы.
##Статы подлежат штрафу за несоблюдение/невыполнение задач и привычек.

Техническая документацию для проекта **RPG Life Tracker**. Система спроектирована с учетом масштабируемости, строгой типизации данных в PostgreSQL и прозрачной математической модели прогрессии.

---

## 1. Общее описание системы

**RPG Life Tracker** — это аналитическая система управления личной эффективностью, использующая игровые механики (гэймификацию) для визуализации прогресса. Система преобразует выполнение повседневных задач и привычек в очки опыта (XP) и уровни характеристик персонажа.

Особенностью данной системы является разделение атрибутов на **активные** (прокачиваемые действием), **творческие** (зависящие от генерации контента) и **состоянийные** (энергия как скользящее среднее).

---

## 2. Схема Базы Данных (PostgreSQL)

Схема нормализована для обеспечения целостности данных и возможности построения исторических отчетов.

### Основные таблицы

#### Таблица `users` & `characters`

| Поле | Тип данных | Описание |
| --- | --- | --- |
| `user_id` | UUID (PK) | Уникальный идентификатор пользователя |
| `username` | VARCHAR(50) | Имя пользователя |
| `level` | INTEGER | Текущий уровень персонажа |
| `xp` | INTEGER | Текущий опыт |
| `strength` | NUMERIC(5,2) | Сила (подлежит штрафам)|
| `stamina` | NUMERIC(5,2) | Стойкость (подлежит штрафам)|
| `agility` | NUMERIC(5,2) | Ловкость (подлежит штрафам)|
| `intellect` | NUMERIC(5,2) | Интеллект (подлежит штрафам) |
| `creativity` | NUMERIC(5,2) | Креативность |

#### Таблица `habits` (Привычки)

| Поле | Тип данных | Описание |
| --- | --- | --- |
| `habit_id` | UUID (PK) | ID привычки |
| `user_id` | UUID (FK) | Ссылка на владельца |
| `title` | TEXT | Название привычки |
| `difficulty` | ENUM | 'easy', 'medium', 'hard' |
| `type` | ENUM | 'binary' (да/нет), 'quantitative' (числовая) |
| `target_value` | INTEGER | Цель (для количественных) |
| `attr_reward` | ENUM | Какой атрибут развивает (Strength, Agility и т.д.) |

#### Таблица `energy_logs` (Журнал энергии)

| Поле | Тип данных | Описание |
| --- | --- | --- |
| `log_id` | BIGSERIAL (PK) | ID записи |
| `user_id` | UUID (FK) | Ссылка на пользователя |
| `value` | SMALLINT | Субъективная оценка (1-10) |
| `created_at` | DATE | Дата замера |

#### Таблица `attribute_history` (Логи изменений)

| Поле | Тип данных | Описание |
| --- | --- | --- |
| `history_id` | BIGSERIAL | ID записи |
| `character_id` | UUID (FK) | Ссылка на персонажа |
| `attribute` | VARCHAR(20) | Название атрибута |
| `change_value` | NUMERIC(5,2) | Значение изменения (+/-) |
| `reason` | TEXT | Причина (Task ID, Habit ID или штраф) |
| `timestamp` | TIMESTAMPTZ | Время события |

---

## 3. Математическая модель RPG Logic Design

### Расчет опыта (XP) и атрибутов

Каждое действие имеет базовое значение . Итоговое начисление зависит от сложности:

* **Коэффициенты сложности ():**
* Легкий (Easy): 
* Средний (Medium): 
* Сложный (Hard): 



**Формула XP:**


**Формула атрибута:**
Прирост атрибута составляет фиксированный процент от базового опыта, например :


### Логика "Креативности"

Атрибут растет только при создании контента (записи в блоге, код, текст).

* За каждую созданную запись в системе (Content Log) начисляется фиксированный бонус:  к Креативности.
* Система проверяет уникальность и объем (минимум символов), чтобы избежать "спама" для прокачки.

### Алгоритм "Энергии" (Moving Average)

Энергия не прокачивается действиями, а отражает состояние. Расчет производится как простое скользящее среднее (Simple Moving Average) за последние 30 календарных дней.


Где:

*  — значение в день .
*  — количество дней, за которые есть записи (но не более 30).

### Система штрафов

Штрафы применяются к атрибуту **Интеллект** при провале задач или пропуске привычек.

* **Механика:** При отметке "Провал" или наступлении дедлайна (для задач) без выполнения, система вызывает триггер:
* `Intellect = Intellect - (BasePenalty * K_d)`


* Ручное назначение штрафа доступно администратору (пользователю) через интерфейс "Покаяния", где можно выбрать величину деградации атрибута.

---

## 4. Функциональные требования и CRUD

### Управление привычками и задачами

1. **Create:** Создание привычки с выбором типа (бинарная/числовая) и привязкой к одному из 4-х штрафуемых атрибутов.
2. **Read:** Получение списка активных задач на сегодня с индикацией прогресса.
3. **Update:** Обновление статуса. Для количественных привычек — частичное выполнение (например, "прошел 5 км из 10").
4. **Delete:** Архивация привычки (статистика сохраняется, но привычка больше не требует выполнения).

### Система штрафов

* Пользователь может вручную инициировать "Штрафной лог", если считает, что нарушил дисциплину вне системы.
* Автоматический расчет штрафа за просроченные задачи (To-Do) с дедлайном.

---

## 5. Спецификация API (REST)

| Метод | Эндпоинт | Описание |
| --- | --- | --- |
| `GET` | `/api/v1/character` | Получение всех статов и уровня персонажа |
| `POST` | `/api/v1/habits` | Создание новой привычки |
| `PATCH` | `/api/v1/habits/{id}/check` | Отметка о выполнении привычки (начисление XP/атрибутов) |
| `POST` | `/api/v1/energy-logs` | Ввод субъективного показателя энергии за день |
| `GET` | `/api/v1/analytics/energy` | Получение значения скользящего среднего за 30 дней |
| `POST` | `/api/v1/penalties` | Ручное наложение штрафа на Интеллект |
| `GET` | `/api/v1/history` | История изменений атрибутов для построения графиков |

> **Дисклеймер:** Показатель "Энергия" является исключительно игровым механизмом саморефлексии и не может использоваться для медицинской диагностики состояния здоровья.